# Internship-Assignment_1
Internship_Assignment_1_SQL
In this Assignment, I provided the solutions to the tasks that are given to me.

-- SQL Internship Questions -- 1. Basic Queries: -- 1.1 List All Customers select* from customers; -- 1.2 Show all products in the 'Electronics' category. select * from products where category = 'electronics'; -- 1.3 Find the total number of orders placed. select count(*) as Total_Orders from Orders; -- 1.4 Display the details of the most recent order. select * from orders order by OrderDate Desc limit 1;

-- 2. Joins and Relationships

-- 2.1. List all products along with the names of the customers who ordered them.

select p.ProductID, p.Name as Product_Name, c.name as Customer_Name from products p join orderdetails od on p.ProductID = od.ProductID join orders o on od.OrderID=o.orderID join Customers c on o.orderID= c.customerID;

-- 2.2. Show orders that include more than one product SELECT o.OrderID, COUNT(od.ProductID) AS ProductCount FROM Orders o JOIN OrderDetails od ON o.OrderID = od.OrderID GROUP BY o.OrderID HAVING COUNT(od.ProductID) > 1;

-- 2.3. Find the total sales amount for each customer select * from (Select c.CustomerID, c.Name AS CustomerName, sum(od.Quantity * od.PricePerUnit) AS Total_Sales_Amount FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN OrderDetails od ON o.OrderID = od.OrderID JOIN Products p ON od.ProductID = p.ProductID GROUP BY c.CustomerID) z order by total_sales_amount desc;

-- 3. Aggregation and Grouping -- 3.1. Calculate the total revenue generated by each product category. select p.category,sum(od.quantity*od.priceperunit) from orderdetails od join products p on od.productID= p.productID group by p.category;

-- 3.2. Determine the average order value.

SELECT AVG(TotalOrderValue) AS AverageOrderValue FROM ( SELECT o.OrderID, SUM(od.Quantity * p.Price) AS TotalOrderValue FROM Orders o JOIN OrderDetails od ON o.OrderID = od.OrderID JOIN Products p ON od.ProductID = p.ProductID GROUP BY o.OrderID ) AS OrderTotals;

-- 3.3. Find the month with the highest number of orders. SELECT EXTRACT(MONTH FROM Orderdate) AS Month,COUNT(*) AS No_of_orders FROM Orders GROUP BY month ORDER BY No_of_orders DESC LIMIT 1; -- 4. Subqueries and Nested Queries: -- 4.1. Identify customers who have not placed any orders. select c.customerID,c.Name from customers c left join orders o on c.customerID=o.customerID where o.customerID is null;

-- 4.2. Find products that have never been ordered. select p.productID,p.Name from products p left join orderdetails od on p.productID=od.OrderID where od.productID is null;

-- 4.3. Show the top 3 best-selling products. select p.productID,p.Name, sum(od.quantity) as Total_quantity_sold from products p join orderdetails od on p.productID- od.productID group by p.productID order by Total_quantity_sold desc limit 3; -- or select ProductID,sum(Quantity) from orderdetails group by ProductID order by quantity desc limit 3;

-- 5 5. Date and Time Functions: -- 5.1. List orders placed in the last month. SELECT * FROM Orders WHERE OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) AND OrderDate <= CURRENT_DATE; -- 5.2. Determine the oldest customer in terms of membership duration. SELECT CustomerID, Name, DATEDIFF(CURRENT_DATE, JoinDate) AS MembershipDuration FROM Customers ORDER BY MembershipDuration DESC LIMIT 1;

-- 7. Data Manipulation and Updates: -- 7.1. Add a new customer to the Customers table. insert into customers (customerID,name,email,joindate) values ( 11,"Abhishek","ab@example.com",'2022-12-12');

-- 7.2. Update the price of a specific product. UPDATE Products SET Price = 25.99 WHERE ProductID = 5
